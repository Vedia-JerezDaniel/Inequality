---
title: "R Notebook"
output: html_notebook
---

```{r,message=FALSE}
library(tidyverse)
library(lpirfs)
library(dplyr)
```

```{r, message=FALSE}
library(readxl)
lpf <- read_excel("final.xlsx")
```

```{r}
fd <- as.data.frame(lpf %>%
  arrange(idem, year) %>%  # Sort by firm and then by year
  group_by(idem) %>%      # Tell dplyr to go within each firm
  mutate(gdppc_gro = GDP_pc/(lag(GDP_pc)-1),
         gdp_gro = GDP/(lag(GDP)-1),
         insde_d = ins_effic/(lag(ins_effic)-1),
         tot_d = TOT/(lag(TOT)-1), 
         debt_d = Gov_debt/(lag(Gov_debt)-1),
         redis = Gini_market - Gini_net/Gini_net,
         pi_m = PIT*mrp_all,
         pi_a = PIT*arp_mid, 
         rd = sav_gdp*res_1mill,
         rd1= sav_gdp*RD_gdp))
```


## LOCAL IMPULSE ESTIMATIONS


```{r}
# Exclude observations
data_sample <- seq(1990, 2018)[which(!(seq(1990, 2018) %in% c(seq(1991, 1992),seq(2000, 2001), seq(2008, 2009), seq(2011, 2013))))]

```


```{r}
ln <- fd %>%
          dplyr::select(id, year, Gini_net, gdp_gro, Trade, Gov_ex, Secondary_ed, employ_rate,          Education_exp,  Health_exp,  Soc_kind, Soc_payable, Social_prot_ex_pen, Unemp_tra,Property_taxes, PIT, ind_tx, Corporate_ta, mrp_all, arp_mid, pi_a, pi_m, sav_gdp, RD_gdp, res_1mill, rd, rd1)
```

## WITHOUT RECESSION

```{r, warning=FALSE}
p1 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Education_exp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint  = 1.96, hor = 5)

lp1 = data.frame(x =1:5,mean=c(p1[["irf_panel_mean"]]),low=c(p1[["irf_panel_low"]]),up=c(p1[["irf_panel_up"]]))

p2 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Health_exp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lp2 = data.frame(x =1:5,mean=c(p2[["irf_panel_mean"]]),low=c(p2[["irf_panel_low"]]),up=c(p2[["irf_panel_up"]]))

p3 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Soc_kind",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lp3 = data.frame(x =1:5,mean=c(p3[["irf_panel_mean"]]),low=c(p3[["irf_panel_low"]]),up=c(p3[["irf_panel_up"]]))

p4 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Soc_payable",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lp4 = data.frame(x =1:5,mean=c(p4[["irf_panel_mean"]]),low=c(p4[["irf_panel_low"]]),up=c(p4[["irf_panel_up"]]))

p5 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Social_prot_ex_pen",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lp5 = data.frame(x =1:5,mean=c(p5[["irf_panel_mean"]]),low=c(p5[["irf_panel_low"]]),up=c(p5[["irf_panel_up"]]))
```

## RECESSION SAMPLE

```{r, warning=FALSE}
pr1 <-  lp_lin_panel(data_set          = ln,
                               data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Education_exp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint  = 1.96, hor = 5)

lpr1 = data.frame(x =1:5,mean=c(pr1[["irf_panel_mean"]]),low=c(pr1[["irf_panel_low"]]),up=c(pr1[["irf_panel_up"]]))

pr2 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Health_exp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lpr2 = data.frame(x =1:5,mean=c(pr2[["irf_panel_mean"]]),low=c(pr2[["irf_panel_low"]]),up=c(pr2[["irf_panel_up"]]))

pr3 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Soc_kind",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lpr3 = data.frame(x =1:5,mean=c(pr3[["irf_panel_mean"]]),low=c(pr3[["irf_panel_low"]]),up=c(pr3[["irf_panel_up"]]))

pr4 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Soc_payable",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lpr4 = data.frame(x =1:5,mean=c(pr4[["irf_panel_mean"]]),low=c(pr4[["irf_panel_low"]]),up=c(pr4[["irf_panel_up"]]))

pr5 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Social_prot_ex_pen",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lpr5 = data.frame(x =1:5,mean=c(pr5[["irf_panel_mean"]]),low=c(pr5[["irf_panel_low"]]),up=c(pr5[["irf_panel_up"]]))
```

```{r}
cfi <- function(x, m, l, u, c, t) {
  plot(x, m, ylim = c(y2,y1), type = "l",main = t, xlab = "horizon", ylab= '')
  polygon(c(x,rev(x)),c(l,rev(u)),density=15, col = 'pink', border = NA)
  lines(x, m, lwd = 2,col = c)
  lines(x, u, lty = 'dashed',col="pink")
  lines(x, l, lty = 'dashed',col="pink")
}
```

```{r}
## "Education_exp"

y1 = max(lp1$up) + 0.05
y2 = min(lp1$low) - 0.05 

par(mfrow=c(1,2))

cfi(lp1$x,lp1$mean,lp1$low,lp1$up, 'blue', 'Normal')

y1 = 0.1
y2 = min(lpr1$low) - 0.05 

cfi(lpr1$x,lpr1$mean,lpr1$low,lpr1$up, 'orange', 'Recession')
```
```{r}
## "Health_exp"

y1 = 0.1
y2 = -0.2

par(mfrow=c(1,2))

cfi(lp2$x,lp2$mean,lp2$low,lp2$up, 'blue', 'Normal')

y1 = 0.1
y2 = -0.2 

cfi(lpr2$x,lpr2$mean,lpr2$low,lpr2$up, 'orange', 'Recession')
```

```{r}
## "Transfers in Kind"

y1 = max(lp3$up) + 0.05
y2 = min(lp3$low) - 0.05

par(mfrow=c(1,2))

cfi(lp3$x,lp3$mean,lp3$low,lp3$up, 'blue', 'Normal')

cfi(lpr3$x,lpr3$mean,lpr3$low,lpr3$up, 'orange', 'Recession')
```

```{r}
## "Transfers in Cash"
y1 = max(lp4$up) + 0.05
y2 = min(lp4$low) - 0.05

par(mfrow=c(1,2))

cfi(lp4$x,lp4$mean,lp4$low,lp4$up, 'blue', 'Normal')

cfi(lpr4$x,lpr4$mean,lpr4$low,lpr4$up, 'orange', 'Recession')
```

```{r}
## Social_prot_ex_pen

y1 = max(lp5$up) + 0.05
y2 = min(lp5$low) - 0.05

par(mfrow=c(1,2))

cfi(lp5$x,lp5$mean,lp5$low,lp5$up, 'blue', 'Normal')

cfi(lpr5$x,lpr5$mean,lpr5$low,lpr5$up, 'orange', 'Recession')
```

## TAXES

```{r}
t1 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Property_taxes",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov       = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

lt1 = data.frame(x =1:5,mean=c(t1[["irf_panel_mean"]]),low=c(t1[["irf_panel_low"]]),up=c(t1[["irf_panel_up"]]))

t2 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "pi_m",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

lt2 = data.frame(x =1:5,mean=c(t2[["irf_panel_mean"]]),low=c(t2[["irf_panel_low"]]),up=c(t2[["irf_panel_up"]]))

t3 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "ind_tx",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

lt3 = data.frame(x =1:5,mean=c(t3[["irf_panel_mean"]]),low=c(t3[["irf_panel_low"]]),up=c(t3[["irf_panel_up"]]))

```

```{r}
tr1 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "Property_taxes",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov       = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,  confint  = 1.96, hor = 5)

ltr1 = data.frame(x =1:5,mean=c(tr1[["irf_panel_mean"]]),low=c(tr1[["irf_panel_low"]]),up=c(tr1[["irf_panel_up"]]))

tr2 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "pi_m",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

ltr2 = data.frame(x =1:5,mean=c(tr2[["irf_panel_mean"]]),low=c(tr2[["irf_panel_low"]]),up=c(tr2[["irf_panel_up"]]))

tr3 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "ind_tx",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                                robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

ltr3 = data.frame(x =1:5,mean=c(tr3[["irf_panel_mean"]]),low=c(tr3[["irf_panel_low"]]),up=c(tr3[["irf_panel_up"]]))

```


```{r}
## Property_taxes

y1 = max(lt1$up) + 0.05
y2 = min(lt1$low) - 0.05

par(mfrow=c(1,2))

cfi(lt1$x,lt1$mean,lt1$low,lt1$up, 'blue', 'Normal')

cfi(ltr1$x,ltr1$mean,ltr1$low,ltr1$up, 'orange', 'Recession')
```


```{r}
## PIT

y1 = max(lt2$up) + 0.05
y2 = min(lt2$low) - 0.05

par(mfrow=c(1,2))

cfi(lt2$x,lt2$mean,lt2$low,lt2$up, 'blue', 'Normal')

cfi(ltr2$x,ltr2$mean,ltr2$low,ltr2$up, 'orange', 'Recession')
```


```{r}
## ind_tx

y1 = max(lt3$up) + 0.05
y2 = min(lt3$low) - 0.05

par(mfrow=c(1,2))

cfi(lt3$x,lt3$mean,lt3$low,lt3$up, 'blue', 'Normal')

cfi(ltr3$x,ltr3$mean,ltr3$low,ltr3$up, 'orange', 'Recession')
```

## R&D

```{r}
d1 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "RD_gdp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,
                               confint           = 1.96,
                               hor               = 5)

ld1 = data.frame(x =1:5,mean=c(d1[["irf_panel_mean"]]),low=c(d1[["irf_panel_low"]]),up=c(d1[["irf_panel_up"]]))

d2 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "sav_gdp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

ld2 = data.frame(x =1:5,mean=c(d2[["irf_panel_mean"]]),low=c(d2[["irf_panel_low"]]),up=c(d2[["irf_panel_up"]]))

d3 <-  lp_lin_panel(data_set          = ln,
                              # data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "rd1",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

ld3 = data.frame(x =1:5,mean=c(d3[["irf_panel_mean"]]),low=c(d3[["irf_panel_low"]]),up=c(d3[["irf_panel_up"]]))
```

## RECESSION

```{r}
dr1 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "RD_gdp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1,
                               confint           = 1.96,
                               hor               = 5)

ldr1 = data.frame(x =1:5,mean=c(dr1[["irf_panel_mean"]]),low=c(dr1[["irf_panel_low"]]),up=c(dr1[["irf_panel_up"]]))

dr2 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "sav_gdp",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

ldr2 = data.frame(x =1:5,mean=c(dr2[["irf_panel_mean"]]),low=c(dr2[["irf_panel_low"]]),up=c(dr2[["irf_panel_up"]]))

dr3 <-  lp_lin_panel(data_set          = ln,
                              data_sample       = data_sample,
                               endog_data        = c("Gini_net"),
                               cumul_mult        = TRUE,
                               shock             = "rd1",
                               diff_shock        = TRUE,
                               panel_model       = "within",
                               panel_effect      = "individual",
                               robust_cov        = "vcovSCC", robust_type="HC0", robust_cluster= "vcovHC",
                               c_exog_data       = c('gdp_gro','employ_rate', 'Gov_ex',"Secondary_ed"),
                               c_fd_exog_data    = colnames(ln)[c(seq(5,8))],
                               l_fd_exog_data    = colnames(ln)[c(seq(3,4))],
                               lags_fd_exog_data = 1, confint = 1.96, hor = 5)

ldr3 = data.frame(x =1:5,mean=c(d3[["irf_panel_mean"]]),low=c(d3[["irf_panel_low"]]),up=c(d3[["irf_panel_up"]]))
```

```{r}
## R&D

y1 = max(ld1$up) + 0.05
y2 = min(ld1$low) - 0.05

par(mfrow=c(1,2))

cfi(ld1$x,ld1$mean,ld1$low,ld1$up, 'blue', 'Normal')

cfi(ldr1$x,ldr1$mean,ldr1$low,ldr1$up, 'orange', 'Recession')
```

```{r}
## Savings

y1 = max(ld2$up) + 0.05
y2 = min(ld2$low) - 0.05

par(mfrow=c(1,2))

cfi(ld2$x,ld2$mean,ld2$low,ld2$up, 'blue', 'Normal')

cfi(ldr2$x,ldr2$mean,ldr2$low,ldr2$up, 'orange', 'Recession')
```

```{r}
## R&D * Savings no funciona

y1 = max(ld3$up) + 0.05
y2 = min(ld3$low) - 0.05

par(mfrow=c(1,2))

cfi(ld3$x,ld3$mean,ld3$low,ld3$up, 'blue', 'Normal')

cfi(ldr3$x,ldr3$mean,ldr3$low,ldr3$up, 'orange', 'Recession')
```